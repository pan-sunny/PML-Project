segmentationOriginal[,"Case"=="Train",]
segmentationOriginal["Case"=="Train",]
segmentationOriginal[1,"Case"=="Train",]
subset(segmentationOriginal, Case=="Train")
summary(subset(segmentationOriginal, Case=="Train"))
training <- subset(segmentationOriginal, Case=="Train")
testing <- subset(segmentationOriginal, Case=="Test")
dim(training)
dim(testing)
table
table(segmentationOriginal$Case)
set.seed(125)
modFit <- train(Case~., method="rpart", data=training)
modFit <- train(Case~., method="rpart", data=training)
modFit <- train(training$Case ~ . , method="rpart", data=training)
head(training)
str(training)
modFit <- train(training, method="rpart", data=training)
modFit <- train(method="rpart", data=training)
modFit <- train(,,method="rpart", data=training)
modFit <- train(.,method="rpart", data=training)
modFit <- train(segmentationOriginal,method="rpart", data=training)
inTrain <- createDataPartition(y=segmentationOriginal$Case,p=0.75,list=FALSE)
training <- segmentationOriginal[inTrain,]
testing <- segmentationOriginal[-inTrain,]
head(training)
table(training)
table(training$Case)
set.seed(125)
modFit <- train(class~., method="rpart", data = training)
modFit <- train(training$Class~., method="rpart", data = training)
modFit <- train(Class~., method="rpart", data = training)
print(modFit$finalModel)
predict(modFit, testing)
modFit$finalModel
library(rattle)
suppressMessages(library(rattle))
install.packages("rattle")
library(rattle)
fancyRpartPlot(modFit$finalModel)
library(pgmm)
data(olive)
olive = olive[,-1]
str(olive)
modFit <- train(Area~., data = olive, method="rf")
modFit <- train(Area~., data = olive, method="rf", prox=TRUE)
modFit <- train(Area~., data = olive, method="rpart")
modFit <- train(Area~., method="rpart", data = olive)
newdata = as.data.frame(t(colMeans(olive)))
predict(modFit, newdata)
head(newdata)
head(olive)
colMeans(olive)
t(colMeans(olive))
predict(modFit$finalModel, newdata)
modFit$finalModel
library(ElemStatLearn)
data(SAheart)
set.seed(8484)
train = sample(1:dim(SAheart)[1],size=dim(SAheart)[1]/2,replace=F)
trainSA = SAheart[train,]
testSA = SAheart[-train,]
str(SAheart)
dim(SAheart)[1]
dim(SAheart)[1]/2
set.seed(13234)
train(chd~age+alohol+obesity+tobacco+typea+ldl, data=trainSA,method="glm", family="binomial")
train(chd~age+alcohol+obesity+tobacco+typea+ldl, data=trainSA,method="glm", family="binomial")
modFit<-train(chd~age+alcohol+obesity+tobacco+typea+ldl, data=trainSA,method="glm", family="binomial")
missClass = function(values,prediction){sum(((prediction > 0.5)*1) != values)/length(values)}
missClass(testSA$chd,predict(modFit, newdata = testSA))
missClass(trainSA$chd,predict(modFit, newdata = trainSA))
missClass = function(values,prediction){sum(((prediction > 0.5)*1) != values)/length(values)}
missClass(trainSA,predict(modFit, newdata = trainSA))
missClass(trainSA$chd,predict(modFit, newdata = trainSA))
missClass(trainSA$chd,predict(modFit, newdata = testSA))
missClass(testSA$chd, predict(modelSA, newdata = testSA))
missClass(testSA$chd, predict(modFit, newdata = testSA))
set.seed(13234)
modelSA <- train(chd ~ age + alcohol + obesity + tobacco + typea + ldl,
data = trainSA, method = "glm", family = "binomial")
missClass(testSA$chd, predict(modelSA, newdata = testSA))
missClass(trainSA$chd, predict(modelSA, newdata = trainSA))
library(ElemStatLearn)
data(vowel.train)
data(vowel.test)
str(vowel.train)
str(vowel.test)
vowel.train$y <- as.factor(vowel.train)$y
vowel.train$y <- as.factor(vowel.train$y)
vowel.test$y <- as.factor(vowel.test$y)
set.seed(33833)
modFit <- train(y~., data=vowel.train, method="rf", prox=TRUE)
modFit$finalModel
?randomForest()
?varImp
varImp(modFit, method="rf")
modvowel <- randomForest(y ~ ., data = vowel.train)
library(randomForest)
modvowel <- randomForest(y ~ ., data = vowel.train)
order(varImp(modvowel), decreasing = T)
varImp(modvowel)
order(varImp(modFit), decreasing = T)
order(varImp(modFit$finalModel), decreasing = T)
vowel.train$y <- as.factor(vowel.train$y)
vowel.test$y <- as.factor(vowel.test$y)
set.seed(33833)
library(randomForest)
modvowel <- randomForest(y ~ ., data = vowel.train)
order(varImp(modvowel), decreasing = T)
install.packages("randomForest")
library(ElemStatLearn)
data(vowel.train)
data(vowel.test)
vowel.train$y <- as.factor(vowel.train$y)
vowel.test$y <- as.factor(vowel.test$y)
set.seed(33833)
library(randomForest)
modvowel <- randomForest(y ~ ., data = vowel.train)
order(varImp(modvowel), decreasing = T)
rfNews()
library(ElemStatLearn)
data(vowel.train)
data(vowel.test)
vowel.train$y <- as.factor(vowel.train$y)
vowel.test$y <- as.factor(vowel.test$y)
set.seed(33833)
library(randomForest)
install.packages("randomForest")
library(ElemStatLearn)
data(vowel.train)
data(vowel.test)
vowel.train$y <- as.factor(vowel.train$y)
vowel.test$y <- as.factor(vowel.test$y)
set.seed(33833)
library(randomForest)
packageVersion("randomForest")
modvowel <- randomForest(y ~ ., data = vowel.train)
order(varImp(modvowel), decreasing = T)
modvowel <- randomForest(y ~ ., data = vowel.train)
varImp(modvowel)
library(caret)
modvowel <- randomForest(y ~ ., data = vowel.train)
order(varImp(modvowel), decreasing = T)
vowel.train$y <- as.factor(vowel.train$y)
vowel.test$y <- as.factor(vowel.test$y)
set.seed(33833)
library(randomForest)
modFit <- train(y~., data = vowel.train, method="rf")
order(varImp(modFit), decreasing = T)
order(varImp(modFit$finalModel), decreasing = T)
packageVersion("AppliedPredictiveModeling")
packageVersion("caret")
packageVersion("rpart")
packageVersion("pgmm")
packageVersion("ElemStatLearm")
packageVersion("ElemStatLearn")
packageVersion("gbm")
install.packages("gbm")
install.packages("gbm")
install.packages("gbm")
install.packages("gbm")
packageVersion(gbm)
packageVersion("gbm")
packageVersion("lubridate")
packageVersion("forecast")
install.packages("forecast")
install.packages("forecast")
install.packages("forecast")
packageVersion("forecast")
install.packages(c("forecast", "v5.6"))
packageVersion("forecast")
require(devtools)
install_version("AppliedPredictiveModeling", version = "1.1.6",repos = "http://cran.us.r-project.org")
install_version("AppliedPredictiveModeling", version = "1.1.6",repos = "http://cran.us.r-project.org")
remove.packages("AppliedPredictiveModeling")
install_version("AppliedPredictiveModeling", version = "1.1.6",repos = "http://cran.us.r-project.org")
remove.packages("AppliedPredictiveModeling")
install.packages("C:/My/CourseDS/CourseBooks/lib/AppliedPredictiveModeling_1.1-6.tar.gz", repos = NULL, type = "source")
packageVersion("AppliedPredictiveModeling")
remove.packages("caret")
install.packages("C:/My/CourseDS/CourseBooks/lib/caret_6.0-47.tar.gz", repos = NULL, type = "source")
install.packages("caret")
packageVersion("caret")
install.packages("C:/My/CourseDS/CourseBooks/lib/caret_6.0-47.tar.gz", repos = NULL, type = "source")
remove.packages("caret")
install.packages("C:/My/CourseDS/CourseBooks/lib/BradleyTerry2_1.0-4.tar.gz", repos = NULL, type = "source")
install.packages("caret")
packageVersion("caret")
packageVersion("ElemStatLearn")
remove.packages("pgmm")
install.packages("C:/My/CourseDS/CourseBooks/lib/pgmm_1.1.tar.gz", repos = NULL, type = "source")
packageVersion("pgmm")
packageVersion("rpart")
remove.packages("rpart")
install.packages("C:/My/CourseDS/CourseBooks/lib/rpart_4.1-8.tar.gz", repos = NULL, type = "source")
packageVersion("rpart")
packageVersion("gbm")
removeVersion("gbm")
remove.packages("gbm")
install.packages("C:/My/CourseDS/CourseBooks/lib/gbm_2.1.tar.gz", repos = NULL, type = "source")
removeVersion("gbm")
packageVersion("gbm")
packageVersion("lubridate")
remove.packages("lubridate")
install.packages("C:/My/CourseDS/CourseBooks/lib/lubridate_1.3.3.tar.gz", repos = NULL, type = "source")
packageVersion("lubridate")
install.packages("lubridate")
packageVersion("lubridate")
packageVersion("forecast")
remove.packages("forecast")
install.packages("C:/My/CourseDS/CourseBooks/lib/forecast_5.6.tar.gz", repos = NULL, type = "source")
packageVersion("forecast")
packageVersion("e1071")
remove.packages("e1071")
install.packages("C:/My/CourseDS/CourseBooks/lib/e1071_1.6-4.tar.gz", repos = NULL, type = "source")
packageVersion("e1071")
install.packages("C:/My/CourseDS/CourseBooks/lib/caret_6.0-47.tar.gz", repos = NULL, type = "source")
packageVersion("caret")
install.packages("BradleyTerry2")
remove.packages("caret")
install.packages("C:/My/CourseDS/CourseBooks/lib/caret_6.0-47.tar.gz", repos = NULL, type = "source")
packageVersion("caret")
packageVersion("pgmm")
packageVersion("rpart")
packageVersion("lubridate")
install.packages("C:/My/CourseDS/CourseBooks/lib/lubridate_1.3.3.tar.gz", repos = NULL, type = "source")
packageVersion("lubridate")
remove.packages("lubridate")
install.packages("lubridate")
library(ElemStatLearn)
data(vowel.train)
data(vowel.test)
head(vowel.train)
head(vowel)
vowel.train$y <- as.factor(vowel.train$y)
str(vowel.train)
str(vowel.test)
head(vowel.train)
vowel.test$y <- as.factor(vowel.test$y)
set.seed(33833)
library(caret)
set.seed(33833)
modRf <- train(y~., data = vowel.train, method="rf")
library(ggplot2)
modRf <- train(y~., data = vowel.train, method="rf")
packageVersion("randomForest")
print(modRf$finalModel)
predict(modRf, vowel.test)
confusionMatrix(vowel.test$y, predict(modRf, vowel.test))
modGbm <- train(y~., data = vowel.train, method="gbm")
modGbm <- train(y~., data = vowel.train, method="gbm", verbose=FALSE)
predRf<-predict(modRf, vowel.test)
predGbm<-predict(modGbm, vowel.test)
predDF <- data.frame(predRf, predGbm, y=vowel.test$y)
xmodFit <- train(y~., method="gam", data = predDF)
xmodFit <- train(y~., method="gbm", data = predDF)
xmodFit <- train(y~., method="gbm", data = predDF, verbose=FALSE)
confusionMatrix(vowel.test$y, predict(xmodFit, vowel.test))
confusionMatrix(vowel.test$y, predict(modGbm, vowel.test))
confusionMatrix(vowel.test$y, predict(modGbm, vowel.test))[1]
confusionMatrix(vowel.test$y, predict(modGbm, vowel.test))[2]
confusionMatrix(vowel.test$y, predict(modGbm, vowel.test))$Accuracy
confusionMatrix(vowel.test$y, predict(modGbm, vowel.test))[Accuracy ]
confusionMatrix(vowel.test$y, predict(modGbm, vowel.test))[Accuracy, ]
confusionMatrix(vowel.test$y, predict(modRf, vowel.test))
confusionMatrix(vowel.test$y, predict(modGbm, vowel.test))
confusionMatrix(vowel.test$y, predict(xmodFit, vowel.test))
library(caret)
library(gbm)
set.seed(3433)
library(AppliedPredictiveModeling)
data(AlzheimerDisease)
head(AlzheimerDisease)
head(diagnosis)
head(predictors)
adData = data.frame(diagnosis,predictors)
head(adData)
head(adData,2)
str(adData)
inTrain = createDataPartition(adData$diagnosis, p = 3/4)[[1]]
training = adData[ inTrain,]
testing = adData[-inTrain,]
head(training)
str(training)
set.seed(62433)
modRf<-train(diagnosis~., data = training, method="rf")
modLda<-train(diagnosis~., data = training, method="lda")
modGbm<-train(diagnosis~., data = training, method="gbm", verbose=FALSE)
modLda<-train(diagnosis~., data = training, method="lda")
predRf <- predict(modRf, testing)
predLda <- predict(modLda, testing)
predGbm <- predict(modGbm, testing)
predDF <- data.frame(predRf, predGbm, predLda, diagnosis=testing$diagnosis)
xmodFit <- train(diagnosis~., method="rf", data = predDF)
head(predDF)
confusionMatrix(testing$diagnosis, predRf)
confusionMatrix(testing$diagnosis, predGbm)
confusionMatrix(testing$diagnosis, predLda)
xmodFit <- train(diagnosis~., method="rf", data = predDF)
str(predDF)
predDFRG <- data.frame(predRf, predGbm, diagnosis=testing$diagnosis)
xmodRG <- train(diagnosis~., method="rf", data = predDFRG)
str(testing)
predDF$predRf <- as.numeric(predDF$predRf)
predDF$predGbm <- as.numeric(predDF$predGbm)
predDF$predLda <- as.numeric(predDF$predLda)
xmodRG <- train(diagnosis~., method="rf", data = predDF)
xmodRG <- train(diagnosis~., method="rf", data = predDF, matrix=matrix)
xmod <- train(diagnosis~., method="rf", data = predDF, matrix="Accuracy")
xmod <- train(diagnosis~., method="rf", data = predDF, trControl=control)
xmod <- train(diagnosis~., method="gam", data = predDF, matrix="Accuracy")
xmod <- train(diagnosis~., method="rf", data = predDF)
confusionMatrix(testing$diagnosis, predict(xmod,testing))
predDF <- data.frame(predRf, predGbm, predLda, diagnosis=testing$diagnosis)
xmodFit <- train(diagnosis~., method="rf", data = predDF)
combPred <- predict(xmodFit, predDF)
confusionMatrix(testing$diagnosis, combPred)
sqrt(sum((combPred-testing$diagnosis)^2))
set.seed(3523)
library(AppliedPredictiveModeling)
data(concrete)
inTrain = createDataPartition(concrete$CompressiveStrength, p = 3/4)[[1]]
training = concrete[ inTrain,]
testing = concrete[-inTrain,]
set.seed(233)
head(testing)
library(glmnet)
install.packages("glmnet")
library(glmnet)
cv <- cv.glmnet(x, y, alpha = 1)
?train
?plot.mrelnet
lm(CompressiveStrength~., data = training)
str(training)
lm(CompressiveStrength~., data = training)
?plot.mrelnet
x<- model.matrix(CompressiveStrength ~ ., training)
y <- training$CompressiveStrength
cv<-cv.glmnet(x,y,alpha=1)
cv$lambda.min
modFit <- glmnet(x, y, alpha = 1, lambda = cv$lambda.min)
coef(modFit)
modFit <- glmnet(x, y, alpha = 1, lambda = 0)
coef(modFit)
library("elasticnet")
install.packages("elasticnet")
set.seed(233)
modLasso<- train(CompressiveStrength~., data = training, method="lasso")
plot.enet(modLasso$finalModel, xvar="penalty", use.color = true)
plot.enet(modLasso$finalModel, xvar="penalty", use.color = TRUE)
plot.enet(modLasso$finalModel, xvar="penalty", use.color = TRUE)
plot.enet(modLasso$finalModel, xvar="penalty")
plot.enet(modLasso$finalModel, xvar="penalty", use.color = true)
plot.enet(modLasso$finalModel, xvar="penalty", use.color = TRUE)
print(modLasso$finalModel)
library(lubridate)
dat = read.csv("./gaData.csv")
head(dat)
training = dat[year(dat$date) < 2012,]
testing = dat[(year(dat$date)) > 2011,]
head(training)
head(testing)
tstrain = ts(training$visitsTumblr)
?bats
library(forecast)
?forecast
modFit <- bats(tstrain)
dim(testing)[1]
dim(testing)
fcast <- forecast(modFit, level = 0.95, h = dim(testing)[1])
plot(fcast)
sum(fcast$lower<testing$visitsTumblr&fcast$upper>testing$visitsTumblr)/dim(testing)[1]
sum( testing$visitsTumblr < fcast$lower & testing$visitsTumblr < fcast$upper)/dim(testing)[1]
sum( testing$visitsTumblr < fcast$lower & testing$visitsTumblr < fcast$upper)/dim(testing)[1]
sum( testing$visitsTumblr > fcast$lower & testing$visitsTumblr < fcast$upper)/dim(testing)[1]
sum(fcast$lower <= testing$visitsTumblr & testing$visitsTumblr <= fcast$upper) / dim(testing)[1]
dat = read.csv("gaData.csv")
training = dat[year(dat$date) < 2012,]
testing = dat[(year(dat$date)) > 2011,]
tstrain = ts(training$visitsTumblr)
fit <- bats(tstrain)
fcast <- forecast(fit, nrow(testing), level = c(95))
plot(fcast)
points(dat$visitsTumblr)
print(sum(fcast$lower <= testing$visitsTumblr & testing$visitsTumblr <= fcast$upper) / dim(testing)[1])
library(lubridate)
dat = read.csv("gaData.csv")
training = dat[year(dat$date) < 2012,]
testing = dat[(year(dat$date)) > 2011,]
tstrain = ts(training$visitsTumblr)
fit <- basts(trtrain)
fit <- bats(trtrain)
fit <- basts(tstrain)
fit <- bats(tstrain)
fcast<- forecast(fit, level = 0.95, h=dim(testing)[1])
sum(testing$visitsTumblr>fcast$lower & testing$visitsTumblr<fcast$upper)/dim(testing)[1]
?forecast
dim(testing)[1]
print(sum(fcast$lower <= testing$visitsTumblr & testing$visitsTumblr <= fcast$upper) / dim(testing)[1])
fcast<- forecast(fit, level = 95, h=dim(testing)[1])
print(sum(fcast$lower <= testing$visitsTumblr & testing$visitsTumblr <= fcast$upper) / dim(testing)[1])
set.seed(3523)
library(AppliedPredictiveModeling)
data(concrete)
inTrain = createDataPartition(concrete$CompressiveStrength, p = 3/4)[[1]]
training = concrete[ inTrain,]
testing = concrete[-inTrain,]
set.seed(325)
library(e1071)
modSvm <- svm(CompressiveStrength~., training)
predSvm <- predict(modSvm, testing)
accuracy(predSvm, testing$CompressiveStrength)
set.seed(325)
library(e1071)
mod_svm <- svm(CompressiveStrength ~ ., data = training)
pred_svm <- predict(mod_svm, testing)
accuracy(pred_svm, testing$CompressiveStrength)
library(caret)
library(gbm)
set.seed(3433)
library(AppliedPredictiveModeling)
data(AlzheimerDisease)
adData = data.frame(diagnosis,predictors)
inTrain = createDataPartition(adData$diagnosis, p = 3/4)[[1]]
training = adData[ inTrain,]
testing = adData[-inTrain,]
set.seed(62433)
mod_rf <- train(diagnosis ~ ., data = training, method = "rf")
mod_gbm <- train(diagnosis ~ ., data = training, method = "gbm")
mod_lda <- train(diagnosis ~ ., data = training, method = "lda")
pred_rf <- predict(mod_rf, testing)
pred_gbm <- predict(mod_gbm, testing)
pred_lda <- predict(mod_lda, testing)
predDF <- data.frame(pred_rf, pred_gbm, pred_lda, diagnosis = testing$diagnosis)
combModFit <- train(diagnosis ~ ., method = "rf", data = predDF)
combPred <- predict(combModFit, predDF)
confusionMatrix(pred_rf, testing$diagnosis)$overall[1]
confusionMatrix(pred_gbm, testing$diagnosis)$overall[1]
confusionMatrix(pred_lda, testing$diagnosis)$overall[1]
confusionMatrix(combPred, testing$diagnosis)$overall[1]
training = read.csv("pml-training.csv")
training = read.csv("./pml-training.csv")
setwd("C:/Work/R/datasciencecoursera/PML_Project")
training = read.csv("./pml-training.csv")
str(training)
head(training)
str(training)
?nearZeroVar
library(ggplot2)
library(dplyr)
library(caret)
?nearZeroVar
summary(training)
dim(trainging)
dim(training)
training = read.csv("./pml-training.csv", header = T, na.strings = c("","NA"))
dim(training)
testing = read.csv("./pml-testing.csv", header = T, na.strings = c("","NA"))
dim(testing)
nvz <- nearZeroVar(training)
head(nvz)
tmp1<- training[,-nvz]
dim(tmp1)
str(training)
tmp1 <- training[,colMeans(is.na(training)) < .9]
dim(tmp1)
nvz <- nearZeroVar(traincsv)
tmp <- training[,-nvz]
dim(tmp)
str(tmp1)
tmp2 <- tmp1[tmp1,-c(1:7)]
tmp1 <- training[,colMeans(is.na(training)) < .9]
dim(tmp1)
tmp11 <- tmp1[,-c(1:7)]
dim(tmp11)
str(tmp11)
training <- training[,colMeans(is.na(training)) < 0.9]
training <- training[,-c(1:7)]
dim(training)
inTrain <- createDataPartition(y=training$classe, 0.7, list = F)
train <- training[inTrain,]
valid <- training[-inTrain,]
set.seed(123)
inTrain <- createDataPartition(y=training$classe, p=0.7, list = FALSE)
train <- training[inTrain,]
valid <- training[-inTrain,]
dim(train)
dim(valid)
13737+5885
library(caret)
modCT <- train(classe~., data=train, method="rpart", trControl=trControl)
?rpart
library(rpart)
modCT <- train(classe~., data=train, method="rpart", trControl=trControl)
myControl <- trainControl(method = "cv", number = 5)
modCT <- train(classe~., data=train, method="rpart", trControl=myControl)
library(rattle)
fancyRpartPlot(modCT$finalModel)
knitr::opts_chunk$set(echo = TRUE)
modCT <- train(classe~., data=train, method="rpart", trControl=myControl)
fancyRpartPlot(modCT$finalModel)
modCT <- train(classe~., data=train, method="rpart", trControl=myControl)
fancyRpartPlot(modCT$finalModel)
confusionMatrix(valid$classe, predict(modCT, valid))
confusionMatrix(valid$classe, predict(modCT, valid))$overall[1]
cmCT <- confusionMatrix(valid$classe, predict(modCT, valid))
cmCT$overall[1]
modRF <- train(classe~., data=train, method="rf", trControl=myControl)
library(ggplot2)
library(dplyr)
modRF <- train(classe~., data=train, method="rf", trControl=myControl)
